openapi: 3.0.3
info:
  title: TripTastic API
  description: |
    Travel API for searching and booking flights and hotels.
    
    **IMPORTANT**: Call /api/System/current-date first to get today's date before planning any trips.
    
    ## Supported Destinations
    - **US Cities**: New York (JFK), Los Angeles (LAX), Chicago (ORD), Dallas (DFW), Denver (DEN), San Francisco (SFO), Seattle (SEA), Miami (MIA), Boston (BOS), Atlanta (ATL)
    - **International**: London (LHR), Paris (CDG), Frankfurt (FRA), Tokyo (NRT), Sydney (SYD)
    
    ## Booking Flow
    1. Call getCurrentDate to get today's date
    2. Call planTrip to get flight and hotel options
    3. Call addFlightToCart for outbound flight
    4. Call addFlightToCart for return flight
    5. Call addHotelToCart for hotel
    6. Call checkout to complete booking
  version: 1.0.0

servers:
  - url: https://triptastic.azurewebsites.net
    description: Production server

paths:
  /api/System/current-date:
    get:
      operationId: getCurrentDate
      summary: Get the current date - CALL THIS FIRST
      description: Returns the current date in UTC. Essential for AI agents to get temporal context.
      responses:
        '200':
          description: Current date information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CurrentDateResponse'

  /api/TripPlanner/plan:
    get:
      operationId: planTrip
      summary: Get flight and hotel options for a round-trip
      description: Returns available outbound flights, return flights, and hotels. Use the IDs to add items to cart.
      parameters:
        - name: origin
          in: query
          required: true
          description: Origin airport code (e.g., SEA, JFK, LAX)
          schema:
            type: string
        - name: destination
          in: query
          required: true
          description: Destination airport code (e.g., LAX, CDG, NRT)
          schema:
            type: string
        - name: departureDate
          in: query
          required: true
          description: Departure date (YYYY-MM-DD)
          schema:
            type: string
            format: date
        - name: returnDate
          in: query
          required: true
          description: Return date (YYYY-MM-DD)
          schema:
            type: string
            format: date
        - name: travelers
          in: query
          description: Number of travelers
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Flight and hotel options
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TripPlan'

  /api/Cart:
    get:
      operationId: getCart
      summary: Get the current shopping cart
      description: Returns the current shopping cart with all items.
      responses:
        '200':
          description: Cart contents
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'
    delete:
      operationId: clearCart
      summary: Clear all items from the cart
      responses:
        '200':
          description: Empty cart
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'

  /api/Cart/flights:
    post:
      operationId: addFlightToCart
      summary: Add a flight to the cart
      description: Add outbound or return flight using flight ID from planTrip results.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddFlightToCartRequest'
      responses:
        '200':
          description: Updated cart
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'
        '404':
          description: Flight not found

  /api/Cart/hotels:
    post:
      operationId: addHotelToCart
      summary: Add a hotel to the cart
      description: Add hotel using hotel ID from planTrip results.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddHotelToCartRequest'
      responses:
        '200':
          description: Updated cart
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'
        '404':
          description: Hotel not found

  /api/Cart/checkout:
    post:
      operationId: checkout
      summary: Checkout and book the trip
      description: Completes checkout and creates a confirmed trip. Cart is cleared after.
      responses:
        '200':
          description: Booking confirmation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckoutResponse'
        '400':
          description: Cart is empty

  /api/Cart/trips:
    get:
      operationId: getAllTrips
      summary: Get all booked trips
      responses:
        '200':
          description: List of booked trips
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BookedTripsResponse'

  /api/Cart/trips/{tripId}:
    get:
      operationId: getTrip
      summary: Get a specific booked trip
      parameters:
        - name: tripId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Trip details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BookedTripResponse'
        '404':
          description: Trip not found

  /api/Cart/trips/{tripId}/cancel:
    post:
      operationId: cancelTrip
      summary: Cancel a booked trip
      parameters:
        - name: tripId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Trip cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CancelTripResponse'
        '404':
          description: Trip not found

components:
schemas:
  CurrentDateResponse:
    type: object
    properties:
      currentDateFormatted:
        type: string
        description: Current date as YYYY-MM-DD string
      dayOfWeek:
        type: string
      tomorrow:
        type: string
        format: date

  Flight:
    type: object
    properties:
      id:
        type: string
        format: uuid
      airline:
        type: string
      flightNumber:
        type: string
      origin:
        type: string
      destination:
        type: string
      departureTime:
        type: string
        format: date-time
      arrivalTime:
        type: string
        format: date-time
      price:
        type: number

  Hotel:
    type: object
    properties:
      id:
        type: string
        format: uuid
      name:
        type: string
      location:
        type: string
      starRating:
        type: integer
      pricePerNight:
        type: number
      amenities:
        type: array
        items:
          type: string

  HotelAvailability:
      type: object
      properties:
        hotel:
          $ref: '#/components/schemas/Hotel'
        totalPrice:
          type: number
        nights:
          type: integer

    TripPlan:
      type: object
      description: Available flights and hotels for a trip
      properties:
        origin:
          type: string
        destination:
          type: string
        departureDate:
          type: string
          format: date
        returnDate:
          type: string
          format: date
        nights:
          type: integer
        travelers:
          type: integer
        outboundFlights:
          type: array
          items:
            $ref: '#/components/schemas/Flight'
          description: Flights from origin to destination on departure date
        returnFlights:
          type: array
          items:
            $ref: '#/components/schemas/Flight'
          description: Flights from destination to origin on return date
        hotels:
          type: array
          items:
            $ref: '#/components/schemas/HotelAvailability'
          description: Hotels at the destination

    AddFlightToCartRequest:
      type: object
      required:
        - flightId
      properties:
        flightId:
          type: string
          format: uuid
          description: Flight ID from planTrip results
        passengers:
          type: integer
          default: 1

    AddHotelToCartRequest:
      type: object
      required:
        - hotelId
        - checkInDate
        - checkOutDate
      properties:
        hotelId:
          type: string
          format: uuid
          description: Hotel ID from planTrip results
        checkInDate:
          type: string
          format: date
          description: Check-in date (same as departure date)
        checkOutDate:
          type: string
          format: date
          description: Check-out date (same as return date)
        rooms:
          type: integer
          default: 1
        guests:
          type: integer
          default: 1

    CartResponse:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/CartItem'
        totalItems:
          type: integer
        totalPrice:
          type: number

    CartItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum: [flight, hotel]
        description:
          type: string
        totalPrice:
          type: number
        flight:
          $ref: '#/components/schemas/CartFlightInfo'
        hotel:
          $ref: '#/components/schemas/CartHotelInfo'

    CartFlightInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        airline:
          type: string
        flightNumber:
          type: string
        origin:
          type: string
        destination:
          type: string
        departureTime:
          type: string
          format: date-time
        arrivalTime:
          type: string
          format: date-time
        pricePerSeat:
          type: number
        passengers:
          type: integer

    CartHotelInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        location:
          type: string
        starRating:
          type: integer
        pricePerNight:
          type: number
        checkInDate:
          type: string
          format: date
        checkOutDate:
          type: string
          format: date
        nights:
          type: integer
        rooms:
          type: integer
        guests:
          type: integer

    CheckoutResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        bookedTrip:
          $ref: '#/components/schemas/BookedTripResponse'

    BookedTripsResponse:
      type: object
      properties:
        trips:
          type: array
          items:
            $ref: '#/components/schemas/BookedTripResponse'
        totalTrips:
          type: integer

    BookedTripResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        confirmationCode:
          type: string
        status:
          type: string
        bookedAt:
          type: string
          format: date-time
        totalPrice:
          type: number
        flights:
          type: array
          items:
            $ref: '#/components/schemas/BookedFlightInfo'
        hotels:
          type: array
          items:
            $ref: '#/components/schemas/BookedHotelInfo'

    BookedFlightInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        confirmationCode:
          type: string
        airline:
          type: string
        flightNumber:
          type: string
        origin:
          type: string
        destination:
          type: string
        departureTime:
          type: string
          format: date-time
        arrivalTime:
          type: string
          format: date-time
        passengers:
          type: integer
        pricePerSeat:
          type: number
        totalPrice:
          type: number

    BookedHotelInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        confirmationCode:
          type: string
        hotelName:
          type: string
        location:
          type: string
        starRating:
          type: integer
        checkInDate:
          type: string
          format: date
        checkOutDate:
          type: string
          format: date
        nights:
          type: integer
        rooms:
          type: integer
        guests:
          type: integer
        pricePerNight:
          type: number
        totalPrice:
          type: number

    CancelTripResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        tripId:
          type: string
          format: uuid
